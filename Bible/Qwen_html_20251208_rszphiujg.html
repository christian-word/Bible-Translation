<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ò–∑—É—á–µ–Ω–∏–µ –ë–∏–±–ª–∏–∏ —Å –ò–ò</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: system-ui, -apple-system, sans-serif; }
        .verse-highlight { background-color: #fef3c7; }
        .scrollbar-thin::-webkit-scrollbar { width: 6px; }
        .scrollbar-thin::-webkit-scrollbar-track { background: #f1f1f1; }
        .scrollbar-thin::-webkit-scrollbar-thumb { background: #888; border-radius: 3px; }
        .scrollbar-thin::-webkit-scrollbar-thumb:hover { background: #555; }
        /* Mobile AI Panel */
        #aiPanel.mobile-fullscreen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            z-index: 1000;
            display: flex !important;
            flex-direction: column;
        }
        /* Verse comparison layout */
        @media (max-width: 767px) {
            .mobile-verse-row {
                display: flex;
                overflow-x: auto;
                padding: 8px 0;
                gap: 12px;
                scroll-behavior: smooth;
                -webkit-overflow-scrolling: touch;
            }
            .mobile-verse-translation {
                min-width: 280px;
                padding: 12px;
                background: #f9fafb;
                border-radius: 8px;
                box-shadow: 0 1px 2px rgba(0,0,0,0.05);
            }
        }
    </style>
</head>
<body class="bg-gray-50">
    <div id="app" class="flex flex-col h-screen">
        <!-- HEADER -->
        <header class="bg-white border-b border-gray-200 px-4 py-3 flex items-center justify-between">
            <div class="flex items-center gap-3">
                <svg class="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path>
                </svg>
                <h1 class="text-xl font-bold text-gray-900 hidden md:block">–ò–∑—É—á–µ–Ω–∏–µ –ü–∏—Å–∞–Ω–∏—è</h1>
            </div>
            <div class="flex items-center gap-2">
                <select id="modelSelect" class="p-1 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:outline-none w-40">
                    <option value="" disabled selected>–ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–µ–π...</option>
                </select>
                <label for="fileInput" class="p-2 hover:bg-gray-100 rounded-lg cursor-pointer" title="–ó–∞–≥—Ä—É–∑–∏—Ç—å –ø–µ—Ä–µ–≤–æ–¥—ã –≤—Ä—É—á–Ω—É—é">
                    <svg class="w-5 h-5 text-gray-700" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"></path>
                    </svg>
                </label>
                <input type="file" id="fileInput" multiple accept=".json" class="hidden">
                <button id="testApiBtn" class="p-2 hover:bg-gray-100 rounded-lg" title="–¢–µ—Å—Ç API">
                    <svg class="w-5 h-5 text-gray-700" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                </button>
                <button id="aiToggle" class="p-2 rounded-lg hover:bg-gray-100" title="–û—Ç–∫—Ä—ã—Ç—å –ò–ò-—á–∞—Ç">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path>
                    </svg>
                </button>
                <button id="menuBtn" class="md:hidden p-2 hover:bg-gray-100 rounded-lg">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                    </svg>
                </button>
            </div>
        </header>

        <!-- MAIN LAYOUT -->
        <div class="flex flex-1 overflow-hidden relative">
            <!-- SIDEBAR -->
            <aside id="sidebar" class="hidden md:flex md:w-80 border-r border-gray-200 flex-col bg-white">
                <div class="p-4 border-b border-gray-200">
                    <div class="mb-4 relative">
                        <svg class="absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                        </svg>
                        <input id="searchInput" type="text" placeholder="–ü–æ–∏—Å–∫ –ø–æ —Ç–µ–∫—Å—Ç—É..." class="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:outline-none">
                    </div>
                    <div class="mb-3 flex justify-between items-center">
                        <label class="text-sm font-medium text-gray-700">–ü–µ—Ä–µ–≤–æ–¥—ã:</label>
                        <button id="compareToggle" class="text-xs text-blue-600 hover:underline">–°—Ä–∞–≤–Ω–∏—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã–µ</button>
                    </div>
                    <div id="translationsList" class="space-y-1"></div>
                </div>
                <div class="flex-1 overflow-y-auto scrollbar-thin p-4">
                    <div id="searchResults" class="hidden space-y-2 mb-4"></div>
                    <div id="navigation">
                        <div class="mb-4">
                            <label class="text-sm font-medium text-gray-700 mb-2 block">–ö–Ω–∏–≥–∞:</label>
                            <select id="bookSelect" class="w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:outline-none"></select>
                        </div>
                        <div>
                            <label class="text-sm font-medium text-gray-700 mb-2 block">–ì–ª–∞–≤–∞:</label>
                            <div id="chapterGrid" class="grid grid-cols-5 gap-1"></div>
                            <div id="chapterPagination" class="mt-2 hidden text-center">
                                <button id="loadMoreChapters" class="text-sm text-blue-600 hover:underline">‚Üí –ï—â—ë –≥–ª–∞–≤—ã</button>
                            </div>
                        </div>
                    </div>
                </div>
            </aside>

            <!-- MAIN CONTENT -->
            <main class="flex-1 overflow-y-auto scrollbar-thin p-4 md:p-6">
                <div id="loadingScreen" class="max-w-4xl mx-auto text-center py-20">
                    <svg class="w-16 h-16 mx-auto mb-4 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path>
                    </svg>
                    <h2 class="text-2xl font-bold text-gray-900 mb-2">–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...</h2>
                    <p class="text-gray-600 mb-6" id="loadingMessage">–ü–æ–ø—ã—Ç–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤ –ø–µ—Ä–µ–≤–æ–¥–æ–≤...</p>
                    <p class="text-sm text-gray-500">–ï—Å–ª–∏ –∞–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–∞ –Ω–µ —É–¥–∞–ª–∞—Å—å: –Ω–∞–∂–º–∏—Ç–µ –Ω–∞ –∏–∫–æ–Ω–∫—É –∑–∞–≥—Ä—É–∑–∫–∏ –∏ –≤—ã–±–µ—Ä–∏—Ç–µ JSON.</p>
                </div>
                <div id="contentArea" class="max-w-4xl mx-auto hidden">
                    <h2 id="chapterTitle" class="text-2xl font-bold text-gray-900 mb-6"></h2>
                    <div id="versesContainer" class="space-y-6"></div>
                </div>
            </main>

            <!-- AI PANEL -->
            <aside id="aiPanel" class="hidden md:w-96 border-l border-gray-200 flex-col bg-white">
                <div class="p-4 border-b border-gray-200 flex items-center justify-between">
                    <h3 class="font-semibold text-gray-900">–ò–ò-–ø–æ–º–æ—â–Ω–∏–∫ (<span id="currentModelDisplay">...</span>)</h3>
                    <button id="aiClose" class="p-2 hover:bg-gray-100 rounded-lg">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>
                <div id="aiMessages" class="flex-1 overflow-y-auto scrollbar-thin p-4 space-y-4">
                    <div class="text-center text-gray-500 mt-8">
                        <svg class="w-12 h-12 mx-auto mb-3 text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path>
                        </svg>
                        <p class="text-sm">–ó–∞–¥–∞–π—Ç–µ –≤–æ–ø—Ä–æ—Å –æ —Ç–µ–∫—Å—Ç–µ</p>
                        <p class="text-xs mt-2">–ù–∞–ø—Ä.: "–°—Ä–∞–≤–Ω–∏ –ø–µ—Ä–µ–≤–æ–¥—ã —ç—Ç–æ–≥–æ —Å—Ç–∏—Ö–∞"</p>
                    </div>
                </div>
                <div class="p-4 border-t border-b border-gray-200 bg-gray-50 flex flex-wrap gap-2 justify-center">
                    <button onclick="sendSummary()" class="text-xs px-2 py-1 bg-blue-100 text-blue-800 rounded-full hover:bg-blue-200">
                        üí° –°–≤–æ–¥–∫–∞ –ì–ª–∞–≤—ã
                    </button>
                    <button onclick="sendCrossReferences()" class="text-xs px-2 py-1 bg-purple-100 text-purple-800 rounded-full hover:bg-purple-200">
                        üîó –°–≤—è–∑–∞–Ω–Ω—ã–µ –°—Ç–∏—Ö–∏
                    </button>
                </div>
                <div class="p-4 border-t border-gray-200">
                    <div class="flex gap-2">
                        <input id="aiInput" type="text" placeholder="–ó–∞–¥–∞–π—Ç–µ –≤–æ–ø—Ä–æ—Å..." class="flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:outline-none">
                        <button id="aiSend" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">‚Üí</button>
                    </div>
                </div>
            </aside>
        </div>
    </div>

    <script>
        // === CONFIGURATION ===
        const TRANSLATIONS = {
            'HOM_–•–æ–º–µ–Ω–∫–æ': { name: '–•–æ–º–µ–Ω–∫–æ', lang: 'üá∫üá¶' },
            'UBIO_–û–≥—ñ—î–Ω–∫–æ': { name: '–û–≥—ñ—î–Ω–∫–æ', lang: 'üá∫üá¶' },
            'UTT_–¢—É—Ä–∫–æ–Ω—è–∫': { name: '–¢—É—Ä–∫–æ–Ω—è–∫', lang: 'üá∫üá¶' },
            'NRT_–ù–æ–≤—ã–π': { name: '–ù–æ–≤—ã–π —Ä—É—Å—Å–∫–∏–π', lang: 'üá∑üá∫' },
            'SYNOD_–°–∏–Ω–æ–¥–∞–ª—å–Ω—ã–π': { name: '–°–∏–Ω–æ–¥–∞–ª—å–Ω—ã–π', lang: 'üá∑üá∫' }
        };
        const DEFAULT_TRANSLATION_FILES = Object.keys(TRANSLATIONS).map(k => k + '.json');
        const GROQ_API_KEY = "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";

        const state = {
            bibleData: {},
            translations: [],
            activeTranslations: [],
            selectedBook: '',
            selectedChapter: '',
            searchQuery: '',
            aiMessages: [],
            isLoading: false,
            models: [],
            displayedChapters: 20
        };

        // === DOM REFERENCES ===
        const MODEL_SELECT = document.getElementById('modelSelect');
        const CURRENT_MODEL_DISPLAY = document.getElementById('currentModelDisplay');
        const LOADING_SCREEN = document.getElementById('loadingScreen');
        const CONTENT_AREA = document.getElementById('contentArea');
        const SIDEBAR = document.getElementById('sidebar');
        const AI_PANEL = document.getElementById('aiPanel');

        // === RENDERING HELPERS ===
        function getTranslationLabel(key) {
            const t = TRANSLATIONS[key];
            return t ? `${t.lang} ${t.name}` : key;
        }

        // === RENDER TRANSLATIONS ===
        function renderTranslations() {
            const list = document.getElementById('translationsList');
            list.innerHTML = state.translations.map(trans => `
                <label class="flex items-center gap-2 text-sm cursor-pointer">
                    <input type="checkbox" ${state.activeTranslations.includes(trans) ? 'checked' : ''} 
                           onchange="toggleTranslation('${trans}')" class="rounded text-blue-600">
                    <span>${getTranslationLabel(trans)}</span>
                </label>
            `).join('');
        }

        function toggleTranslation(trans) {
            const idx = state.activeTranslations.indexOf(trans);
            if (idx >= 0) {
                if (state.activeTranslations.length > 1) {
                    state.activeTranslations.splice(idx, 1);
                }
            } else {
                state.activeTranslations.push(trans);
            }
            renderVerses();
        }

        // === CHAPTER PAGINATION ===
        function renderChapters() {
            const grid = document.getElementById('chapterGrid');
            const pagination = document.getElementById('chapterPagination');
            if (!state.bibleData[state.translations[0]]?.[state.selectedBook]) return;

            const allChapters = Object.keys(state.bibleData[state.translations[0]][state.selectedBook]);
            const showAll = allChapters.length <= 50;
            const toDisplay = showAll ? allChapters : allChapters.slice(0, state.displayedChapters);

            grid.innerHTML = toDisplay.map(ch => `
                <button onclick="selectChapter('${ch}')" 
                        class="p-2 rounded text-sm ${ch === state.selectedChapter ? 'bg-blue-600 text-white' : 'bg-gray-100 hover:bg-gray-200 text-gray-700'}">
                    ${ch}
                </button>
            `).join('');

            if (!showAll) {
                pagination.classList.remove('hidden');
            } else {
                pagination.classList.add('hidden');
            }
        }

        document.getElementById('loadMoreChapters').addEventListener('click', () => {
            state.displayedChapters += 20;
            renderChapters();
        });

        // === VERSes RENDERING (with mobile horizontal layout) ===
        function renderVerses() {
            const container = document.getElementById('versesContainer');
            const title = document.getElementById('chapterTitle');
            title.textContent = `${state.selectedBook} ${state.selectedChapter}`;
            const verses = {};

            state.activeTranslations.forEach(trans => {
                const chapter = state.bibleData[trans]?.[state.selectedBook]?.[state.selectedChapter];
                if (chapter) {
                    Object.keys(chapter).forEach(verseNum => {
                        if (!verses[verseNum]) verses[verseNum] = {};
                        verses[verseNum][trans] = chapter[verseNum];
                    });
                }
            });

            const isMobile = window.innerWidth < 768;
            const verseKeys = Object.keys(verses).sort((a, b) => parseInt(a) - parseInt(b));

            if (isMobile && state.activeTranslations.length > 1) {
                // –ú–æ–±–∏–ª—å–Ω—ã–π: –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∞—è –ø—Ä–æ–∫—Ä—É—Ç–∫–∞ –Ω–∞ –∫–∞–∂–¥—ã–π —Å—Ç–∏—Ö
                container.innerHTML = verseKeys.map(verseNum => `
                    <div id="verse-${verseNum}" class="bg-white rounded-lg p-3 shadow-sm">
                        <div class="flex items-center justify-between mb-2">
                            <span class="flex-shrink-0 w-7 h-7 flex items-center justify-center bg-blue-100 text-blue-600 rounded-full text-xs font-semibold">
                                ${verseNum}
                            </span>
                            <button onclick="copyVerse(${verseNum})" class="p-1 hover:bg-gray-100 rounded" title="–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å">
                                <svg class="w-3.5 h-3.5 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                                </svg>
                            </button>
                        </div>
                        <div class="mobile-verse-row">
                            ${state.activeTranslations.map(trans => `
                                <div class="mobile-verse-translation">
                                    <div class="text-xs text-gray-500 mb-1">${getTranslationLabel(trans)}</div>
                                    <p class="text-gray-800 text-sm">${verses[verseNum][trans]}</p>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `).join('');
            } else {
                // –î–µ—Å–∫—Ç–æ–ø –∏–ª–∏ –æ–¥–∏–Ω –ø–µ—Ä–µ–≤–æ–¥ –Ω–∞ –º–æ–±–∏–ª—å–Ω–æ–º
                container.innerHTML = verseKeys.map(verseNum => `
                    <div id="verse-${verseNum}" class="bg-white rounded-lg p-4 shadow-sm">
                        <div class="flex items-start gap-3">
                            <span class="flex-shrink-0 w-8 h-8 flex items-center justify-center bg-blue-100 text-blue-600 rounded-full text-sm font-semibold">
                                ${verseNum}
                            </span>
                            <div class="flex-1 space-y-3">
                                ${state.activeTranslations.map(trans => `
                                    <div>
                                        <div class="text-xs text-gray-500 mb-1">${getTranslationLabel(trans)}</div>
                                        <p class="text-gray-800 leading-relaxed">${verses[verseNum][trans]}</p>
                                    </div>
                                `).join('')}
                            </div>
                            <button onclick="copyVerse(${verseNum})" class="flex-shrink-0 p-2 hover:bg-gray-100 rounded-lg" title="–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å">
                                <svg class="w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                                </svg>
                            </button>
                        </div>
                    </div>
                `).join('');
            }
        }

        // === COMPARE TOGGLE ===
        document.getElementById('compareToggle').addEventListener('click', () => {
            if (state.activeTranslations.length <= 1) {
                // –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ
                state.activeTranslations = [...state.translations];
            } else {
                // –û—Å—Ç–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤—ã–π
                state.activeTranslations = [state.translations[0]];
            }
            renderTranslations();
            renderVerses();
        });

        // === –û–°–¢–ê–õ–¨–ù–ê–Ø –õ–û–ì–ò–ö–ê (loadModels, sendToAI, navigateTo –∏ —Ç.–¥.) ‚Äî –ë–ï–ó –ò–ó–ú–ï–ù–ï–ù–ò–ô ===
        // (–¥–∞–ª–µ–µ –≤—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –≤—Å—ë –æ—Å—Ç–∞–ª—å–Ω–æ–µ –∏–∑ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞, –∑–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ–º renderVerses, renderTranslations –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≥–ª–∞–≤)

        // ... [–≤–µ—Å—å –æ—Å—Ç–∞–ª—å–Ω–æ–π JS –∏–∑ –æ—Ä–∏–≥–∏–Ω–∞–ª–∞, –≤–∫–ª—é—á–∞—è loadModels(), autoLoadTranslations(), sendToAI(), navigateTo(), makeReferencesClickable –∏ —Ç.–¥.] ...
        // (—è –Ω–µ –ø–æ–≤—Ç–æ—Ä—è—é –µ–≥–æ –∑–¥–µ—Å—å –ø–æ–ª–Ω–æ—Å—Ç—å—é, —á—Ç–æ–±—ã –Ω–µ —É–¥–≤–∞–∏–≤–∞—Ç—å –æ–±—ä—ë–º, –Ω–æ –æ–Ω –æ—Å—Ç–∞—ë—Ç—Å—è 1:1, –∫—Ä–æ–º–µ —É–∫–∞–∑–∞–Ω–Ω—ã—Ö –≤—ã—à–µ —Ñ—É–Ω–∫—Ü–∏–π)

        // === AI PANEL MOBILE HANDLING ===
        document.getElementById('aiToggle').addEventListener('click', () => {
            if (window.innerWidth < 768) {
                AI_PANEL.classList.add('mobile-fullscreen');
            }
            AI_PANEL.classList.toggle('hidden');
            AI_PANEL.classList.toggle('flex');
        });
        document.getElementById('aiClose').addEventListener('click', () => {
            AI_PANEL.classList.add('hidden');
            AI_PANEL.classList.remove('flex', 'mobile-fullscreen');
        });

        // === –û–°–¢–ê–õ–¨–ù–û–ï –¢–û–ß–ù–û –ö–ê–ö –í –û–†–ò–ì–ò–ù–ê–õ–ï ===
        function startAppRendering() {
            if (state.translations.length > 0) {
                state.activeTranslations = [state.translations[0]];
                const firstBook = Object.keys(state.bibleData[state.translations[0]])[0];
                state.selectedBook = firstBook;
                state.selectedChapter = '1';
                LOADING_SCREEN.classList.add('hidden');
                CONTENT_AREA.classList.remove('hidden');
                SIDEBAR.classList.remove('hidden');
                SIDEBAR.classList.add('flex');
                renderTranslations();
                renderBooks();
                renderChapters();
                renderVerses();
            } else {
                document.getElementById('loadingMessage').textContent = '–§–∞–π–ª—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã. –í—ã–±–µ—Ä–∏—Ç–µ –∏—Ö –≤—Ä—É—á–Ω—É—é.';
            }
        }
        async function autoLoadTranslations() {
            let successfulLoads = 0;
            const loadPromises = DEFAULT_TRANSLATION_FILES.map(async (fileName) => {
                try {
                    document.getElementById('loadingMessage').textContent = `–ü–æ–ø—ã—Ç–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏: ${fileName}...`;
                    const response = await fetch(fileName);
                    if (!response.ok) throw new Error(`HTTP ${response.status}`);
                    const text = await response.text();
                    const data = JSON.parse(text);
                    const key = fileName.replace('.json', '');
                    state.bibleData[key] = data;
                    state.translations.push(key);
                    successfulLoads++;
                } catch (error) {}
            });
            await Promise.all(loadPromises);
            document.getElementById('loadingMessage').textContent = successfulLoads > 0
                ? `–£—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ ${successfulLoads} –ø–µ—Ä–µ–≤–æ–¥(–∞/–æ–≤).`
                : '–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –Ω–µ —É–¥–∞–ª–∞—Å—å. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª—ã –≤—Ä—É—á–Ω—É—é.';
            startAppRendering();
        }
        document.getElementById('fileInput').addEventListener('change', async (e) => {
            const files = Array.from(e.target.files);
            if (files.length === 0) return;
            LOADING_SCREEN.classList.remove('hidden');
            document.getElementById('loadingMessage').textContent = '–ó–∞–≥—Ä—É–∑–∫–∞ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤...';
            for (const file of files) {
                try {
                    const text = await file.text();
                    const data = JSON.parse(text);
                    const key = file.name.replace('.json', '');
                    state.bibleData[key] = data;
                    state.translations.push(key);
                } catch (error) {
                    console.error(`Error loading ${file.name}:`, error);
                    alert(`–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–∞ ${file.name}`);
                }
            }
            state.translations = [...new Set(state.translations)];
            startAppRendering();
        });
        async function loadModels() {
            MODEL_SELECT.innerHTML = '<option value="" disabled selected>–ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–µ–π...</option>';
            MODEL_SELECT.disabled = true;
            try {
                const response = await fetch('https://api.groq.com/openai/v1/models', {
                    headers: { 'Authorization': `Bearer ${GROQ_API_KEY}` }
                });
                if (!response.ok) {
                    const errorData = await response.json();
                    throw new Error(`HTTP ${response.status}: ${errorData.error?.message || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞'}`);
                }
                const data = await response.json();
                state.models = (data.data || []).filter(m => 
                    m.id.includes('llama') || m.id.includes('mixtral') || m.id.includes('gemma')
                );
                MODEL_SELECT.innerHTML = state.models.map(m => 
                    `<option value="${m.id}">${m.id}</option>`
                ).join('');
                selectFirstModel();
                MODEL_SELECT.disabled = false;
                CURRENT_MODEL_DISPLAY.textContent = MODEL_SELECT.value;
            } catch (e) {
                console.error("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥–µ–ª–µ–π:", e);
                MODEL_SELECT.innerHTML = `<option value="" disabled selected>–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏</option>`;
                MODEL_SELECT.disabled = true;
                CURRENT_MODEL_DISPLAY.textContent = '–û—à–∏–±–∫–∞';
                alert("–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –º–æ–¥–µ–ª–∏ –ò–ò. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–ª—é—á GROQ_API_KEY.");
            }
        }
        function selectFirstModel() {
            if (state.models.length > 0) {
                const preferredModel = state.models.find(m => m.id.includes('70b') || m.id.includes('mixtral'));
                MODEL_SELECT.value = preferredModel ? preferredModel.id : state.models[0].id;
            } else {
                MODEL_SELECT.innerHTML = `<option value="" disabled selected>–ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π</option>`;
            }
        }
        MODEL_SELECT.addEventListener('change', () => {
            CURRENT_MODEL_DISPLAY.textContent = MODEL_SELECT.value;
        });
        function sendAIShortcut(userPrompt) {
            document.getElementById('aiInput').value = userPrompt;
            sendToAI();
        }
        function sendSummary() {
            sendAIShortcut('–°–¥–µ–ª–∞–π –∫—Ä–∞—Ç–∫—É—é —Å–≤–æ–¥–∫—É —ç—Ç–æ–π –≥–ª–∞–≤—ã –∏ –≤—ã–¥–µ–ª–∏ 3 –∫–ª—é—á–µ–≤—ã–µ –∏–¥–µ–∏. –û–ø–∏—Ä–∞–π—Å—è —Ç–æ–ª—å–∫–æ –Ω–∞ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç.');
        }
        function sendCrossReferences() {
            sendAIShortcut('–ù–∞–π–¥–∏ 5 –Ω–∞–∏–±–æ–ª–µ–µ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö –ø–µ—Ä–µ–∫—Ä–µ—Å—Ç–Ω—ã—Ö —Å—Å—ã–ª–æ–∫ (–ö–Ω–∏–≥–∞ –ì–ª–∞–≤–∞:–°—Ç–∏—Ö) –≤ –¥—Ä—É–≥–∏—Ö —á–∞—Å—Ç—è—Ö –ü–∏—Å–∞–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ—è—Å–Ω—è—é—Ç —Ç–µ–º—É —ç—Ç–æ–π –≥–ª–∞–≤—ã. –£–∫–∞–∂–∏ —Ç–æ–ª—å–∫–æ –ö–Ω–∏–≥–∞ –ì–ª–∞–≤–∞:–°—Ç–∏—Ö, –±–µ–∑ –ø–æ—è—Å–Ω–µ–Ω–∏–π.');
        }
        function baseCleanName(name) {
            return name.toLowerCase().trim().replace(/['"¬´¬ª\.,;:\-]/g, '').replace(/[^–∞-—èa-z0-9\s]/g, '');
        }
        function aggressiveCleanName(name) {
            let cleaned = baseCleanName(name);
            cleaned = cleaned.replace(/^(–∫–Ω–∏–≥–∞\s+–ø—Ä–æ—Ä–æ–∫–∞\s+|–∫–Ω–∏–≥–∞\s+|–ø—Ä–æ—Ä–æ–∫–∞\s+|–ø–æ—Å–ª–∞–Ω–∏–µ\s+–∫\s+|–µ–≤–∞–Ω–≥–µ–ª–∏–µ\s+–æ—Ç\s+|–ø–µ—Ä–≤–æ–µ\s+|–≤—Ç–æ—Ä–æ–µ\s+|—Ç—Ä–µ—Ç—å–µ\s+|—á–µ—Ç–≤–µ—Ä—Ç–æ–µ\s+|–æ—Ç\s+|–∫\s+|—Å–≤—è—Ç–æ–≥–æ\s+|–∞–ø–æ—Å—Ç–æ–ª–∞\s+)/, '');
            cleaned = cleaned.replace(/\s+/g, '');
            if (cleaned.startsWith('–ø—Å–∞–ª–æ–º')) cleaned = '–ø—Å–∞–ª—Ç–∏—Ä—å';
            if (cleaned.includes('–∏—Å–∞–∏')) cleaned = '–∏—Å–∞–∏—è';
            if (cleaned.includes('–∏–µ–∑–µ–∫')) cleaned = '–∏–µ–∑–µ–∫–∏–∏–ª—å';
            if (cleaned.includes('–∏–µ—Ä–µ–º')) cleaned = '–∏–µ—Ä–µ–º–∏—è'; 
            if (cleaned.includes('–¥–∞–Ω–∏–∏')) cleaned = '–¥–∞–Ω–∏–∏–ª';
            if (cleaned.includes('–µ–≤—Ä–µ—è–º')) cleaned = '–ø–æ—Å–ª–∞–Ω–∏–µ–∫–µ–≤—Ä–µ—è–º';
            return cleaned;
        }
        function findBookKey(rawName) {
            if (state.translations.length === 0 || !state.bibleData[state.translations[0]]) return null;
            const dataKeys = Object.keys(state.bibleData[state.translations[0]]);
            const aggressiveInput = aggressiveCleanName(rawName);
            for (const key of dataKeys) {
                const aggressiveKey = aggressiveCleanName(key);
                if (aggressiveKey === aggressiveInput) return key;
                if (aggressiveKey.includes(aggressiveInput) && aggressiveInput.length > 3) return key;
            }
            return null;
        }
        function makeReferencesClickable(text) {
            const referenceRegex = /([\p{L}\p{M}\s\.\-]+)\s(\d{1,3})(:\d{1,3}(-\d{1,3})?)?/gu;
            return text.replace(referenceRegex, (match, book, chapter, versePart) => {
                const verse = versePart ? versePart.substring(1).split('-')[0] : '1'; 
                const cleanedBook = book.trim().replace(/\.$/, ''); 
                return `<a href="#" onclick="navigateTo('${cleanedBook}', '${chapter}', '${verse}'); event.preventDefault();" class="text-blue-600 underline font-medium hover:text-blue-800 transition-colors">${match}</a>`;
            });
        }
        function renderBooks() {
            const select = document.getElementById('bookSelect');
            if (state.translations.length === 0 || !state.bibleData[state.translations[0]]) return;
            const books = Object.keys(state.bibleData[state.translations[0]]);
            select.innerHTML = books.map(book => 
                `<option value="${book}" ${book === state.selectedBook ? 'selected' : ''}>${book}</option>`
            ).join('');
            select.onchange = (e) => {
                state.selectedBook = e.target.value;
                state.selectedChapter = '1';
                state.displayedChapters = 20;
                renderChapters();
                renderVerses();
            };
        }
        function selectChapter(chapter) {
            state.selectedChapter = chapter;
            renderChapters();
            renderVerses();
        }
        function copyVerse(verseNum) {
            const verses = {};
            state.activeTranslations.forEach(trans => {
                const text = state.bibleData[trans]?.[state.selectedBook]?.[state.selectedChapter]?.[verseNum];
                if (text) verses[trans] = text;
            });
            const text = Object.keys(verses).map(trans => 
                `${getTranslationLabel(trans)}: ${verses[trans]}`
            ).join('\n');
            navigator.clipboard.writeText(`${state.selectedBook} ${state.selectedChapter}:${verseNum}\n${text}`);
        }
        document.getElementById('searchInput').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') performSearch();
        });
        function performSearch() {
            const query = document.getElementById('searchInput').value.toLowerCase().trim();
            if (!query) {
                document.getElementById('searchResults').classList.add('hidden');
                document.getElementById('navigation').classList.remove('hidden');
                return;
            }
            const results = [];
            state.activeTranslations.forEach(trans => {
                Object.keys(state.bibleData[trans]).forEach(book => {
                    Object.keys(state.bibleData[trans][book]).forEach(chapter => {
                        Object.keys(state.bibleData[trans][book][chapter]).forEach(verse => {
                            const text = state.bibleData[trans][book][chapter][verse];
                            if (text.toLowerCase().includes(query)) {
                                results.push({ trans, book, chapter, verse, text });
                            }
                        });
                    });
                });
            });
            const container = document.getElementById('searchResults');
            if (results.length > 0) {
                container.classList.remove('hidden');
                document.getElementById('navigation').classList.add('hidden');
                container.innerHTML = `
                    <h3 class="font-semibold text-gray-900 mb-3">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã (${results.length})</h3>
                    ${results.slice(0, 50).map(r => `
                        <button onclick="navigateTo('${r.book}', '${r.chapter}', '${r.verse}')" 
                                class="w-full text-left p-3 bg-gray-50 hover:bg-gray-100 rounded-lg">
                            <div class="text-xs font-medium text-blue-600 mb-1">
                                ${r.book} ${r.chapter}:${r.verse}
                            </div>
                            <div class="text-sm text-gray-700 line-clamp-2">${r.text}</div>
                        </button>
                    `).join('')}
                `;
            }
        }
        function navigateTo(rawBook, chapter, verse) {
            const actualBookKey = findBookKey(rawBook);
            if (!actualBookKey) {
                alert(`–ù–µ —É–¥–∞–ª–æ—Å—å –Ω–∞–π—Ç–∏ –∫–Ω–∏–≥—É "${rawBook}".`);
                return;
            }
            state.selectedBook = actualBookKey;
            state.selectedChapter = chapter;
            document.getElementById('searchInput').value = '';
            document.getElementById('searchResults').classList.add('hidden');
            document.getElementById('navigation').classList.remove('hidden');
            renderBooks();
            state.displayedChapters = 20;
            renderChapters();
            renderVerses();
            setTimeout(() => {
                document.getElementById(`verse-${verse}`)?.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }, 100);
        }
        document.getElementById('aiInput').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') sendToAI();
        });
        document.getElementById('aiSend').addEventListener('click', sendToAI);
        async function sendToAI() {
            const input = document.getElementById('aiInput');
            const message = input.value.trim();
            const selectedModel = MODEL_SELECT.value; 
            if (!message || state.isLoading || !selectedModel || MODEL_SELECT.disabled) {
                if (!selectedModel || MODEL_SELECT.disabled) alert("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –¥–æ–∂–¥–∏—Ç–µ—Å—å –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥–µ–ª–µ–π.");
                return;
            }
            state.isLoading = true;
            input.value = '';
            state.aiMessages.push({ role: 'user', content: message });
            renderAiMessages();
            const context = getContext();
            const systemPrompt = `–¢—ã –ø–æ–º–æ—â–Ω–∏–∫ –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è –ë–∏–±–ª–∏–∏. –¢–≤–æ—è –∑–∞–¥–∞—á–∞ - –ø–æ–º–æ–≥–∞—Ç—å –ø–æ–Ω—è—Ç—å —Ç–µ–∫—Å—Ç, –Ω–æ –ù–ï –¥–∞–≤–∞—Ç—å –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω—ã–µ —Ç–æ–ª–∫–æ–≤–∞–Ω–∏—è.
            –í–ê–ñ–ù–û: –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–ø—Ä–æ—Å–∏–ª –ø–µ—Ä–µ–∫—Ä–µ—Å—Ç–Ω—ã–µ —Å—Å—ã–ª–∫–∏ ('–ù–∞–π–¥–∏ 5 –Ω–∞–∏–±–æ–ª–µ–µ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö –ø–µ—Ä–µ–∫—Ä–µ—Å—Ç–Ω—ã—Ö —Å—Å—ã–ª–æ–∫...'), –¢–û–õ–¨–ö–û –≤—ã–≤–µ–¥–∏ –∏—Ö —Å–ø–∏—Å–∫–æ–º –ö–Ω–∏–≥–∞ –ì–ª–∞–≤–∞:–°—Ç–∏—Ö, –±–µ–∑ –ª–∏—à–Ω–∏—Ö —Å–ª–æ–≤.
–î–æ—Å—Ç—É–ø–Ω—ã–µ –ø–µ—Ä–µ–≤–æ–¥—ã: ${state.activeTranslations.map(t => getTranslationLabel(t)).join(', ')}
–¢–µ–∫—É—â–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç –∏–∑—É—á–µ–Ω–∏—è:
${context}
–ü—Ä–∞–≤–∏–ª–∞:
- –ë—É–¥—å –∫—Ä–∞—Ç–∫–∏–º –∏ –ø–æ –¥–µ–ª—É
- –°—Ä–∞–≤–Ω–∏–≤–∞–π –ø–µ—Ä–µ–≤–æ–¥—ã, –µ—Å–ª–∏ —ç—Ç–æ –ø–æ–ª–µ–∑–Ω–æ
- –û–±—ä—è—Å–Ω—è–π –∫–æ–Ω—Ç–µ–∫—Å—Ç (–∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–π, –∫—É–ª—å—Ç—É—Ä–Ω—ã–π)
- –ó–∞–¥–∞–≤–∞–π –≤–æ–ø—Ä–æ—Å—ã –¥–ª—è —Ä–∞–∑–º—ã—à–ª–µ–Ω–∏—è
- –ù–µ –Ω–∞–≤—è–∑—ã–≤–∞–π –¥–æ–∫—Ç—Ä–∏–Ω—É
- –ù–∞–ø—Ä–∞–≤–ª—è–π –∫ —Ç–µ–∫—Å—Ç—É, –∞ –Ω–µ –æ—Ç –Ω–µ–≥–æ
- –û—Ç–≤–µ—á–∞–π –Ω–∞ —Ä—É—Å—Å–∫–æ–º –∏–ª–∏ —É–∫—Ä–∞–∏–Ω—Å–∫–æ–º (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç —è–∑—ã–∫–∞ –≤–æ–ø—Ä–æ—Å–∞)`;
            try {
                const response = await fetch("https://api.groq.com/openai/v1/chat/completions", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json",
                        "Authorization": `Bearer ${GROQ_API_KEY}`
                    },
                    body: JSON.stringify({
                        model: selectedModel, 
                        messages: [
                            { role: "system", content: systemPrompt },
                            ...state.aiMessages.slice(-10).map(msg => ({ role: msg.role, content: msg.content }))
                        ],
                        temperature: 0.7,
                        max_tokens: 1500
                    })
                });
                const data = await response.json();
                if (!response.ok) {
                    console.error("API Error:", data);
                    state.aiMessages.push({ role: 'assistant', content: `–û—à–∏–±–∫–∞ API: ${data.error?.message || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞'}.` });
                    renderAiMessages();
                    return;
                }
                const aiResponse = data.choices?.[0]?.message?.content || "–ò–∑–≤–∏–Ω–∏—Ç–µ, –ø—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞.";
                state.aiMessages.push({ role: 'assistant', content: aiResponse });
                renderAiMessages();
            } catch (error) {
                console.error("AI Error:", error);
                state.aiMessages.push({ role: 'assistant', content: `–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞—â–µ–Ω–∏–∏ –∫ –ò–ò: ${error.message}` });
                renderAiMessages();
            } finally {
                state.isLoading = false;
            }
        }
        function getContext() {
            let context = `–ö–Ω–∏–≥–∞: ${state.selectedBook}, –ì–ª–∞–≤–∞: ${state.selectedChapter}\n`;
            state.activeTranslations.forEach(trans => {
                context += `\n=== ${getTranslationLabel(trans)} ===\n`;
                const chapter = state.bibleData[trans]?.[state.selectedBook]?.[state.selectedChapter];
                if (chapter) {
                    Object.keys(chapter).forEach(v => {
                        context += `${v}. ${chapter[v]}\n`;
                    });
                }
            });
            return context;
        }
        function renderAiMessages() {
            const container = document.getElementById('aiMessages');
            if (state.aiMessages.length === 0) {
                container.innerHTML = `<div class="text-center text-gray-500 mt-8">
                    <svg class="w-12 h-12 mx-auto mb-3 text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path>
                    </svg>
                    <p class="text-sm">–ó–∞–¥–∞–π—Ç–µ –≤–æ–ø—Ä–æ—Å –æ —Ç–µ–∫—Å—Ç–µ</p>
                    <p class="text-xs mt-2">–ù–∞–ø—Ä–∏–º–µ—Ä: "–°—Ä–∞–≤–Ω–∏ –ø–µ—Ä–µ–≤–æ–¥—ã —ç—Ç–æ–≥–æ —Å—Ç–∏—Ö–∞"</p>
                </div>`;
            } else {
                container.innerHTML = state.aiMessages.map(msg => {
                    const content = msg.role === 'assistant' 
                        ? makeReferencesClickable(msg.content)
                        : msg.content;
                    return `
                        <div class="${msg.role === 'user' ? 'text-right' : 'text-left'}">
                            <div class="inline-block max-w-[85%] p-3 rounded-lg ${
                                msg.role === 'user' 
                                    ? 'bg-blue-600 text-white' 
                                    : 'bg-gray-100 text-gray-800'
                            }">
                                <p class="text-sm whitespace-pre-wrap">${content}</p>
                            </div>
                        </div>
                    `;
                }).join('');
                if (state.isLoading) {
                    container.innerHTML += `
                        <div class="flex items-center gap-2 text-gray-500">
                            <svg class="w-4 h-4 animate-spin" fill="none" viewBox="0 0 24 24">
                                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                            </svg>
                            <span class="text-sm">–î—É–º–∞—é...</span>
                        </div>
                    `;
                }
            }
            container.scrollTop = container.scrollHeight;
        }
        document.getElementById('menuBtn').addEventListener('click', () => {
            SIDEBAR.classList.toggle('hidden');
            SIDEBAR.classList.toggle('flex');
            SIDEBAR.classList.toggle('absolute');
            SIDEBAR.classList.toggle('inset-0');
            SIDEBAR.classList.toggle('z-10');
        });
        document.getElementById('testApiBtn').addEventListener('click', async () => {
            console.log('Testing API...');
            await loadModels(); 
            if (state.models.length > 0) {
                alert('API —Ä–∞–±–æ—Ç–∞–µ—Ç! –î–æ—Å—Ç—É–ø–Ω—ã–µ –º–æ–¥–µ–ª–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã.');
            }
        });
        window.addEventListener('load', () => {
            loadModels();
            autoLoadTranslations();
        });
    </script>
</body>
</html>